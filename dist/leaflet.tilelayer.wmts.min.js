!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("leaflet")):"function"==typeof define&&define.amd?define(["exports","leaflet"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).LTileLayerWMTS={},t.L)}(this,function(t,e){"use strict";function s(t){var e=Object.create(null);return t&&Object.keys(t).forEach(function(s){if("default"!==s){var i=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:function(){return t[s]}})}}),e.default=t,Object.freeze(e)}var i=s(e);class r extends i.TileLayer{constructor(t,e){super(t,e);const{layer:s,tileMatrixSet:r,style:a="default",format:n="image/png",tileMatrixLabels:o,googleMapsCompatible:l=!0,extraParams:c,baseQuery:g,crossOrigin:h,...m}=e||{};if(i.setOptions(this,m),this._labels=o,this._gmc=!0===l,this._baseUrl=t,g&&g.length){const e=t.includes("?")?"&":"?";this._baseUrl=`${t}${e}${g}`}const f=this.getTileSize();if(this._wmtsParams={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:"1.0.0",LAYER:String(s),STYLE:String(a),TILEMATRIXSET:String(r),FORMAT:String(n),WIDTH:String(f.x),HEIGHT:String(f.y)},c)for(const[t,e]of Object.entries(c))this._wmtsParams[t.toUpperCase()]=String(e);h&&(this.options.crossOrigin=!0===h?"":h)}onAdd(t){return this._crs=this.options.crs||t.options.crs,this.on("tileerror",t=>{}),super.onAdd(t)}createTile(t,e){const s=super.createTile(t,e);return this.options.crossOrigin&&!s.crossOrigin&&(s.crossOrigin=this.options.crossOrigin),s}getTileUrl(t){const e=this._tileZoom,s=this._labels&&void 0!==this._labels[e]?this._labels[e]:e,r=t.y,a=t.x;if(!this._gmc&&!this._labels)throw new Error("WMTS: Non-GoogleMapsCompatible grids require tileMatrixLabels mapping.");const n=i.Util.template(this._baseUrl,{s:this._getSubdomain(t)}),o={...this._wmtsParams,TILEMATRIX:String(s),TILEROW:String(r),TILECOL:String(a)};return n+i.Util.getParamString(o,n)}setParams(t,e){if(t.layer&&(this._wmtsParams.LAYER=String(t.layer)),t.style&&(this._wmtsParams.STYLE=String(t.style)),t.tileMatrixSet&&(this._wmtsParams.TILEMATRIXSET=String(t.tileMatrixSet)),t.format&&(this._wmtsParams.FORMAT=String(t.format)),t.tileMatrixLabels&&(this._labels=t.tileMatrixLabels),"boolean"==typeof t.googleMapsCompatible&&(this._gmc=t.googleMapsCompatible),t.extraParams)for(const[e,s]of Object.entries(t.extraParams))this._wmtsParams[e.toUpperCase()]=String(s);if(t.baseQuery){const e=this._url.includes("?")?"&":"?";this._baseUrl=`${this._url}${e}${t.baseQuery}`}return e||this.redraw(),this}}t.WMTS=r,t.wmts=function(t,e){return new r(t,e)}});